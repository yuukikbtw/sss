<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫</title>
<link rel="stylesheet" href="css.css">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00d4ff">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ –¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫</h1>
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
            <div id="connectionStatus" class="connection-status offline">
                <span class="status-icon">üî¥</span>
                <span class="status-text">–û—Ñ—Ñ–ª–∞–π–Ω</span>
            </div>
            
            <div class="header-actions">
                <div id="userInfo" style="display: none;">
                    <div class="user-avatar">
                        <span id="userAvatar">üë§</span>
                    </div>
                    <div class="user-info-content">
                        <div class="user-name" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        <div class="user-level" id="userLevel">
                            <span class="level-emoji">üå±</span>
                            <span class="level-name">–ù–æ–≤–∏—á–æ–∫</span>
                            <span class="level-number">Lvl 1</span>
                        </div>
                        <div class="user-stats">
                            <div class="user-stat">
                                <span>üéØ</span>
                                <span id="userHabitsCount">0</span>
                            </div>
                            <div class="user-stat">
                                <span>üî•</span>
                                <span id="userStreak">0</span>
                            </div>
                        </div>
                        <div class="xp-bar" id="xpBar">
                            <div class="xp-bar-fill" style="width: 0%; background: #22c55e"></div>
                            <span class="xp-text">0/100 XP</span>
                        </div>
                    </div>
                    <div class="user-dropdown-arrow">‚ñº</div>
                    
                    <!-- User Profile Dropdown -->
                    <div class="user-profile-dropdown" id="userProfileDropdown">
                        <div class="profile-header">
                            <div class="profile-avatar-large">
                                <span id="profileAvatarLarge">üë§</span>
                            </div>
                            <div class="profile-name" id="profileName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                            <div class="profile-email" id="profileEmail">user@example.com</div>
                        </div>
                        
                        <div class="profile-stats-grid">
                            <div class="profile-stat-item">
                                <span class="profile-stat-number" id="totalHabits">0</span>
                                <span class="profile-stat-label">–ü—Ä–∏–≤—ã—á–∫–∏</span>
                            </div>
                            <div class="profile-stat-item">
                                <span class="profile-stat-number" id="completedToday">0</span>
                                <span class="profile-stat-label">–°–µ–≥–æ–¥–Ω—è</span>
                            </div>
                            <div class="profile-stat-item">
                                <span class="profile-stat-number" id="longestStreak">0</span>
                                <span class="profile-stat-label">–†–µ–∫–æ—Ä–¥</span>
                            </div>
                        </div>
                        
                        <div class="profile-menu">
                            <button class="profile-menu-item" onclick="openProfileSettings()">
                                <span class="profile-menu-icon">‚öôÔ∏è</span>
                                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
                            </button>
                            <button class="profile-menu-item" onclick="openCategoriesModal()">
                                <span class="profile-menu-icon">üè∑Ô∏è</span>
                                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
                            </button>
                            <button class="profile-menu-item" onclick="exportData()">
                                <span class="profile-menu-icon">üì•</span>
                                –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                            </button>
                            <button class="profile-menu-item" onclick="importData()">
                                <span class="profile-menu-icon">üì§</span>
                                –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                            </button>
                            <div style="height: 1px; background: var(--border-subtle); margin: 8px 0;"></div>
                            <button class="profile-menu-item danger" onclick="logout()">
                                <span class="profile-menu-icon">üö™</span>
                                –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
                            </button>
                        </div>
                    </div>
                </div>
                <div id="authButtons">
                    <button class="btn btn-secondary" onclick="openAuthModal('login')">–í–æ–π—Ç–∏</button>
                    <button class="btn" onclick="openAuthModal('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <div id="appButtons" style="display: none;">
                    <button class="btn btn-secondary" onclick="openCategoriesModal()">
                        üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
                    </button>
                    <button class="btn" onclick="openAddHabitModal()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É
                    </button>
                </div>
            </div>
        </header>

        <main>
            <section class="panel">
                <h2>üìã –ú–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏</h2>
                <div id="errorMessage"></div>
                <div id="habitsList" class="habits-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–≤—ã—á–µ–∫...</div>
                </div>
            </section>

            <aside class="panel">
                <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div id="statsPanel">
                    <div class="empty-state">
                        <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–≤—ã—á–∫—É</h3>
                        <p>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–∏–≤—ã—á–∫—É —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Modal: Add Habit -->
    <div class="modal-overlay" id="addHabitModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É</h3>
                <button class="modal-close" onclick="closeModal('addHabitModal')">&times;</button>
            </div>
            
            <form id="addHabitForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏</label>
                    <input type="text" class="form-input" id="habitName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–∏—Ç—å –≤–æ–¥—É" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-textarea" id="habitDesc" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è</label>
                    <div class="time-selector">
                        <input type="text" class="form-input" id="habitTime" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è" readonly onclick="toggleTimeDropdown()">
                        <div class="time-dropdown" id="timeDropdown">
                            <div class="time-picker">
                                <div class="time-column">
                                    <div class="time-label">–ß–∞—Å</div>
                                    <div class="time-values" id="hourValues"></div>
                                </div>
                                <div class="time-separator">:</div>
                                <div class="time-column">
                                    <div class="time-label">–ú–∏–Ω—É—Ç—ã</div>
                                    <div class="time-values" id="minuteValues"></div>
                                </div>
                            </div>
                            <div class="time-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearTime()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                                <button type="button" class="btn" onclick="confirmTime()">–ì–æ—Ç–æ–≤–æ</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</label>
                    <div class="reminder-selector">
                        <input type="text" class="form-input" id="reminderType" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è" readonly onclick="toggleReminderDropdown()">
                        <div class="reminder-dropdown" id="reminderDropdown">
                            <div class="reminder-option" data-value="none">
                                <div class="reminder-icon">üîï</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–ë–µ–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</div>
                                    <div class="reminder-desc">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
                                </div>
                            </div>
                            <div class="reminder-option" data-value="specific">
                                <div class="reminder-icon">‚è∞</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–í –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
                                    <div class="reminder-desc">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
                                </div>
                            </div>
                            <div class="reminder-option" data-value="interval">
                                <div class="reminder-icon">üîÑ</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã</div>
                                    <div class="reminder-desc">–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reminder-settings" id="specificTimeSettings" style="display: none;">
                            <div class="reminder-time-selector">
                                <input type="text" class="form-input" id="reminderTime" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è" readonly onclick="toggleReminderTimeDropdown()">
                                <div class="time-dropdown" id="reminderTimeDropdown">
                                    <div class="time-picker">
                                        <div class="time-column">
                                            <div class="time-label">–ß–∞—Å</div>
                                            <div class="time-values" id="reminderHourValues"></div>
                                        </div>
                                        <div class="time-separator">:</div>
                                        <div class="time-column">
                                            <div class="time-label">–ú–∏–Ω—É—Ç—ã</div>
                                            <div class="time-values" id="reminderMinuteValues"></div>
                                        </div>
                                    </div>
                                    <div class="time-actions">
                                        <button type="button" class="btn btn-secondary" onclick="clearReminderTime()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                                        <button type="button" class="btn" onclick="confirmReminderTime()">–ì–æ—Ç–æ–≤–æ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reminder-settings" id="intervalSettings" style="display: none;">
                            <div class="interval-selector">
                                <div class="interval-input-group">
                                    <label class="form-label">–ö–∞–∂–¥—ã–µ</label>
                                    <div class="interval-controls">
                                        <input type="number" class="form-input interval-number" id="intervalValue" min="1" max="60" value="1">
                                        <div class="interval-unit-selector">
                                            <input type="text" class="form-input" id="intervalUnit" placeholder="–º–∏–Ω—É—Ç" readonly onclick="toggleIntervalUnit()">
                                            <div class="interval-dropdown" id="intervalUnitDropdown">
                                                <div class="interval-option" data-value="minutes">–º–∏–Ω—É—Ç</div>
                                                <div class="interval-option" data-value="hours">—á–∞—Å–æ–≤</div>
                                                <div class="interval-option" data-value="days">–¥–Ω–µ–π</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <div class="category-selector">
                        <input type="text" class="form-input" id="habitCategory" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é" readonly onclick="toggleCategoryDropdown()">
                        <div class="category-dropdown" id="categoryDropdown">
                            <!-- Categories will be populated here -->
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addHabitModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Edit Habit -->
    <div class="modal-overlay" id="editHabitModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É</h3>
                <button class="modal-close" onclick="closeModal('editHabitModal')">&times;</button>
            </div>
            
            <form id="editHabitForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏</label>
                    <input type="text" class="form-input" id="editHabitName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–∏—Ç—å –≤–æ–¥—É" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-textarea" id="editHabitDesc" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è</label>
                    <div class="time-selector">
                        <input type="text" class="form-input" id="editHabitTime" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è" readonly onclick="toggleEditTimeDropdown()">
                        <div class="time-dropdown" id="editTimeDropdown">
                            <div class="time-picker">
                                <div class="time-column">
                                    <div class="time-label">–ß–∞—Å</div>
                                    <div class="time-values" id="editHourValues"></div>
                                </div>
                                <div class="time-separator">:</div>
                                <div class="time-column">
                                    <div class="time-label">–ú–∏–Ω—É—Ç—ã</div>
                                    <div class="time-values" id="editMinuteValues"></div>
                                </div>
                            </div>
                            <div class="time-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearEditTime()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                                <button type="button" class="btn" onclick="confirmEditTime()">–ì–æ—Ç–æ–≤–æ</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</label>
                    <div class="reminder-selector">
                        <input type="text" class="form-input" id="editReminderType" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è" readonly onclick="toggleEditReminderDropdown()">
                        <div class="reminder-dropdown" id="editReminderDropdown">
                            <div class="reminder-option" data-value="none">
                                <div class="reminder-icon">üîï</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–ë–µ–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</div>
                                    <div class="reminder-desc">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
                                </div>
                            </div>
                            <div class="reminder-option" data-value="specific">
                                <div class="reminder-icon">‚è∞</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–í –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
                                    <div class="reminder-desc">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
                                </div>
                            </div>
                            <div class="reminder-option" data-value="interval">
                                <div class="reminder-icon">üîÑ</div>
                                <div class="reminder-info">
                                    <div class="reminder-title">–ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã</div>
                                    <div class="reminder-desc">–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reminder-settings" id="editSpecificTimeSettings" style="display: none;">
                            <div class="reminder-time-selector">
                                <input type="text" class="form-input" id="editReminderTime" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è" readonly onclick="toggleEditReminderTimeDropdown()">
                                <div class="time-dropdown" id="editReminderTimeDropdown">
                                    <div class="time-picker">
                                        <div class="time-column">
                                            <div class="time-label">–ß–∞—Å</div>
                                            <div class="time-values" id="editReminderHourValues"></div>
                                        </div>
                                        <div class="time-separator">:</div>
                                        <div class="time-column">
                                            <div class="time-label">–ú–∏–Ω—É—Ç—ã</div>
                                            <div class="time-values" id="editReminderMinuteValues"></div>
                                        </div>
                                    </div>
                                    <div class="time-actions">
                                        <button type="button" class="btn btn-secondary" onclick="clearEditReminderTime()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                                        <button type="button" class="btn" onclick="confirmEditReminderTime()">–ì–æ—Ç–æ–≤–æ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reminder-settings" id="editIntervalSettings" style="display: none;">
                            <div class="interval-selector">
                                <div class="interval-input-group">
                                    <label class="form-label">–ö–∞–∂–¥—ã–µ</label>
                                    <div class="interval-controls">
                                        <input type="number" class="form-input interval-number" id="editIntervalValue" min="1" max="60" value="1">
                                        <div class="interval-unit-selector">
                                            <input type="text" class="form-input" id="editIntervalUnit" placeholder="–º–∏–Ω—É—Ç" readonly onclick="toggleEditIntervalUnit()">
                                            <div class="interval-dropdown" id="editIntervalUnitDropdown">
                                                <div class="interval-option" data-value="minutes">–º–∏–Ω—É—Ç</div>
                                                <div class="interval-option" data-value="hours">—á–∞—Å–æ–≤</div>
                                                <div class="interval-option" data-value="days">–¥–Ω–µ–π</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <div class="category-selector">
                        <input type="text" class="form-input" id="editHabitCategory" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é" readonly onclick="toggleEditCategoryDropdown()">
                        <div class="category-dropdown" id="editCategoryDropdown">
                            <!-- Categories will be populated here -->
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editHabitModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        ‚úèÔ∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Categories -->
    <div class="modal-overlay" id="categoriesModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h3>
                <button class="modal-close" onclick="closeModal('categoriesModal')">&times;</button>
            </div>
            
            <div class="categories-list" id="categoriesList">
                <!-- Categories will be populated here -->
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn" onclick="openAddCategoryModal()">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Add Category -->
    <div class="modal-overlay" id="addCategoryModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                <button class="modal-close" onclick="closeModal('addCategoryModal')">&times;</button>
            </div>
            
            <form id="addCategoryForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                    <input type="text" class="form-input" id="categoryName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–ø–æ—Ä—Ç" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–≠–º–æ–¥–∑–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="categoryEmoji" placeholder="üèÉ‚Äç‚ôÇÔ∏è" maxlength="2">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addCategoryModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Auth (Login/Register) -->
    <div class="modal-overlay" id="authModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="authModalTitle">–í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h3>
                <button class="modal-close" onclick="closeModal('authModal')">&times;</button>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" style="display: block;">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="your@email.com" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                
                <div class="form-group">
                    <label class="remember-me">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        –ó–∞–ø–æ–º–Ω–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                    </label>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('authModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        üîë –í–æ–π—Ç–∏
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 16px;">
                    <span style="color: var(--text-muted);">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? </span>
                    <button type="button" class="btn-link" onclick="switchAuthMode('register')">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</button>
                </div>
            </form>
            
            <!-- Register Form -->
            <form id="registerForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" class="form-input" id="registerUsername" placeholder="–í–∞—à–µ –∏–º—è" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="registerEmail" placeholder="your@email.com" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-input" id="registerPassword" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" minlength="6" required>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('authModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        ‚ú® –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 16px;">
                    <span style="color: var(--text-muted);">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? </span>
                    <button type="button" class="btn-link" onclick="switchAuthMode('login')">–í–æ–π–¥–∏—Ç–µ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Profile Settings -->
    <div class="modal-overlay profile-settings-modal" id="profileSettingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h3>
                <button class="modal-close" onclick="closeModal('profileSettingsModal')">&times;</button>
            </div>
            
            <div class="settings-section">
                <h4 class="settings-section-title">
                    <span class="settings-section-icon">üë§</span>
                    –ü—Ä–æ—Ñ–∏–ª—å
                </h4>
                
                <div class="avatar-upload-section">
                    <div class="avatar-upload-preview" onclick="changeAvatar()">
                        <span id="settingsAvatar">üë§</span>
                    </div>
                    <div class="avatar-upload-info">
                        <div class="avatar-upload-title">–ê–≤–∞—Ç–∞—Ä –ø—Ä–æ—Ñ–∏–ª—è</div>
                        <div class="avatar-upload-desc">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —ç–º–æ–¥–∑–∏</div>
                        <button type="button" class="btn btn-secondary" onclick="changeAvatar()">
                            –ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                        </button>
                    </div>
                </div>
                
                <div class="profile-edit-section">
                    <div class="profile-edit-header">
                        <h5>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h5>
                        <button type="button" class="btn btn-secondary btn-small" id="editUsernameBtn" onclick="toggleUsernameEdit()">
                            –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                    </div>
                    <div class="profile-display" id="usernameDisplay">
                        <div class="current-value" id="currentUsername">–¢–µ–∫—É—â–µ–µ –∏–º—è</div>
                    </div>
                    <div class="profile-edit-form" id="usernameEditForm" style="display: none;">
                        <div class="input-with-validation">
                            <input type="text" class="form-input" id="newUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è" 
                                   minlength="2" maxlength="50" onblur="validateNewUsername()" oninput="clearValidationError('newUsername')">
                            <div class="validation-message" id="newUsernameValidation"></div>
                        </div>
                        <div class="input-requirements">
                            ‚Ä¢ –û—Ç 2 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤ ‚Ä¢ –¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
                        </div>
                        <div class="profile-edit-actions">
                            <button type="button" class="btn btn-secondary btn-small" onclick="cancelUsernameEdit()">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="button" class="btn btn-small" onclick="saveUsername()">
                                ‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="profile-edit-section">
                    <div class="profile-edit-header">
                        <h5>üìß Email –∞–¥—Ä–µ—Å</h5>
                        <button type="button" class="btn btn-secondary btn-small" id="editEmailBtn" onclick="toggleEmailEdit()">
                            –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                    </div>
                    <div class="profile-display" id="emailDisplay">
                        <div class="current-value" id="currentEmail">current@email.com</div>
                    </div>
                    <div class="profile-edit-form" id="emailEditForm" style="display: none;">
                        <div class="input-with-validation">
                            <input type="email" class="form-input" id="newEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π email" 
                                   onblur="validateNewEmail()" oninput="clearValidationError('newEmail')">
                            <div class="validation-message" id="newEmailValidation"></div>
                        </div>
                        <div class="input-requirements">
                            ‚Ä¢ –î–µ–π—Å—Ç–≤—É—é—â–∏–π –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã ‚Ä¢ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—Ö–æ–¥–∞
                        </div>
                        <div class="profile-edit-actions">
                            <button type="button" class="btn btn-secondary btn-small" onclick="cancelEmailEdit()">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="button" class="btn btn-small" onclick="saveEmail()">
                                ‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="profile-edit-section">
                    <div class="profile-edit-header">
                        <h5>üîí –ü–∞—Ä–æ–ª—å</h5>
                        <button type="button" class="btn btn-secondary btn-small" id="editPasswordBtn" onclick="togglePasswordEdit()">
                            –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                    </div>
                    <div class="profile-display" id="passwordDisplay">
                        <div class="current-value">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
                    </div>
                    <div class="profile-edit-form" id="passwordEditForm" style="display: none;">
                        <div class="input-with-validation">
                            <label class="form-label-small">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                            <input type="password" class="form-input" id="currentPasswordEdit" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" 
                                   onblur="validateCurrentPasswordEdit()" oninput="clearValidationError('currentPasswordEdit')">
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility('currentPasswordEdit')">
                                <span class="password-toggle-icon">üëÅÔ∏è</span>
                            </button>
                            <div class="validation-message" id="currentPasswordEditValidation"></div>
                        </div>
                        
                        <div class="input-with-validation">
                            <label class="form-label-small">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                            <input type="password" class="form-input" id="newPasswordEdit" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" 
                                   minlength="8" onblur="validateNewPasswordEdit()" oninput="clearValidationError('newPasswordEdit')">
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility('newPasswordEdit')">
                                <span class="password-toggle-icon">üëÅÔ∏è</span>
                            </button>
                            <div class="validation-message" id="newPasswordEditValidation"></div>
                            <div class="password-strength" id="passwordStrengthEdit"></div>
                        </div>
                        
                        <div class="input-with-validation">
                            <label class="form-label-small">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                            <input type="password" class="form-input" id="confirmPasswordEdit" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" 
                                   onblur="validateConfirmPasswordEdit()" oninput="clearValidationError('confirmPasswordEdit')">
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility('confirmPasswordEdit')">
                                <span class="password-toggle-icon">üëÅÔ∏è</span>
                            </button>
                            <div class="validation-message" id="confirmPasswordEditValidation"></div>
                        </div>
                        
                        <div class="input-requirements">
                            <strong>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é:</strong><br>
                            ‚Ä¢ –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤ ‚Ä¢ –ó–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞ ‚Ä¢ –¶–∏—Ñ—Ä–∞ ‚Ä¢ –°–ø–µ—Ü—Å–∏–º–≤–æ–ª (!@#$%^&*)
                        </div>
                        
                        <div class="profile-edit-actions">
                            <button type="button" class="btn btn-secondary btn-small" onclick="cancelPasswordEdit()">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="button" class="btn btn-small" onclick="savePassword()">
                                üîí –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="settings-section">
                <h4 class="settings-section-title">
                    <span class="settings-section-icon">üîî</span>
                    –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                </h4>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                        <div class="settings-label-desc">–ü–æ–ª—É—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–∏–≤—ã—á–∫–∞—Ö</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch" id="pushNotifications" onclick="toggleSetting('pushNotifications')"></div>
                    </div>
                </div>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                        <div class="settings-label-desc">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –Ω–∞ –ø–æ—á—Ç—É</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch" id="emailNotifications" onclick="toggleSetting('emailNotifications')"></div>
                    </div>
                </div>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                        <div class="settings-label-desc">–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∑–≤—É–∫ –ø—Ä–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–∏</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch active" id="soundNotifications" onclick="toggleSetting('soundNotifications')"></div>
                    </div>
                </div>
            </div>
            
            <div class="settings-section">
                <h4 class="settings-section-title">
                    <span class="settings-section-icon">üé®</span>
                    –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
                </h4>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</div>
                        <div class="settings-label-desc">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–º–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch active" id="darkTheme" onclick="toggleSetting('darkTheme')"></div>
                    </div>
                </div>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥</div>
                        <div class="settings-label-desc">–£–º–µ–Ω—å—à–∏—Ç—å –æ—Ç—Å—Ç—É–ø—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch" id="compactView" onclick="toggleSetting('compactView')"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</label>
                    <select class="form-select" id="interfaceLanguage">
                        <option value="ru" selected>–†—É—Å—Å–∫–∏–π</option>
                        <option value="en">English</option>
                        <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-section">
                <h4 class="settings-section-title">
                    <span class="settings-section-icon">üìä</span>
                    –î–∞–Ω–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
                </h4>
                
                <div class="settings-row">
                    <div class="settings-label">
                        <div class="settings-label-title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                        <div class="settings-label-desc">–ü–æ–º–æ—á—å —É–ª—É—á—à–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
                    </div>
                    <div class="settings-control">
                        <div class="toggle-switch active" id="analytics" onclick="toggleSetting('analytics')"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</label>
                    <select class="form-select" id="autoBackup">
                        <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</option>
                        <option value="weekly" selected>–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
                        <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
                        <option value="never">–ù–∏–∫–æ–≥–¥–∞</option>
                    </select>
                </div>
            </div>
            
            <div class="danger-zone">
                <div class="danger-zone-title">
                    <span>‚ö†Ô∏è</span>
                    –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞
                </div>
                <div class="danger-zone-desc">
                    –≠—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã.
                </div>
                <div style="display: flex; gap: 12px;">
                    <button type="button" class="btn btn-secondary" onclick="clearAllData()">
                        –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                    </button>
                    <button type="button" class="btn btn-danger" onclick="deleteAccount()">
                        –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                    </button>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn" onclick="closeModal('profileSettingsModal')">
                    ‚úì –ó–∞–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>
        </div>
    </div>

    <!-- Awards Modal -->
    <div class="modal-overlay" id="awardsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>üèÜ –ù–∞–≥—Ä–∞–¥—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <button class="modal-close" onclick="closeModal('awardsModal')">&times;</button>
            </div>
            
            <div class="modal-content">
                <div class="awards-section">
                    <h3>üìä –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                    <div class="progress-overview">
                        <div class="progress-item">
                            <span class="progress-label">–û–±—â–∏–π –æ–ø—ã—Ç</span>
                            <span class="progress-value" id="totalXP">0 XP</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</span>
                            <span class="progress-value" id="currentLevelText">–ù–æ–≤–∏—á–æ–∫ (1)</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">–ü—Ä–∏–≤—ã—á–µ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                            <span class="progress-value" id="totalCompleted">0</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">–°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Å–µ—Ä–∏—è</span>
                            <span class="progress-value" id="bestStreak">0 –¥–Ω–µ–π</span>
                        </div>
                    </div>
                </div>
                
                <div class="awards-section">
                    <h3>üéñÔ∏è –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –±–µ–π–¥–∂–∏</h3>
                    <div class="badges-grid" id="earnedBadges">
                        <!-- Earned badges will be populated here -->
                    </div>
                </div>
                
                <div class="awards-section">
                    <h3>üîí –î–æ—Å—Ç—É–ø–Ω—ã–µ –±–µ–π–¥–∂–∏</h3>
                    <div class="badges-grid" id="availableBadges">
                        <!-- Available badges will be populated here -->
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn" onclick="closeModal('awardsModal')">
                    ‚úì –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
        </div>
    </div>

    <script src="java.js"></script>
</body>
</html>